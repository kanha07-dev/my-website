<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Slot + Wallet (Instant Add Funds)</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      min-height: 100vh;
      background: #f8f9fa;
    }
    .slot {
      font-size: 3rem;
      border: 3px solid #343a40;
      border-radius: 0.5rem;
      width: 70px;
      height: 70px;
      line-height: 70px;
      margin: 0 8px;
      background: white;
      user-select: none;
      display: inline-block;
      text-align: center;
    }
    #gameResult {
      min-height: 2em;
      font-weight: 600;
      margin-top: 15px;
    }
    #qrCode {
      margin: 0 auto 15px auto;
      width: 200px;
      height: 200px;
    }
    .bet-btn.active {
      background-color: #0d6efd;
      color: white;
      border-color: #0d6efd;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="text-center mb-4">Web Developer Slot Machine 🎰</h1>

    <!-- Contact form -->
    <div id="contactSection" class="mx-auto" style="max-width: 400px;">
      <form id="contactForm" class="card p-4 shadow-sm bg-white rounded">
        <div class="mb-3">
          <label for="name" class="form-label">Name:</label>
          <input id="name" type="text" class="form-control" required autocomplete="off" />
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email:</label>
          <input id="email" type="email" class="form-control" required autocomplete="off" />
        </div>
        <button type="submit" class="btn btn-primary w-100">Submit</button>
      </form>
    </div>

    <!-- Game area -->
    <div id="gameArea" class="text-center mt-5" style="display: none;">
      <div class="mb-3">
        <h2>🎰 Slot Machine</h2>
        <div class="fs-4">💰 Wallet: ₹<span id="walletBalance">50</span></div>
      </div>

      <div class="mb-3">
        <p>Choose your bet:</p>
        <div class="d-flex justify-content-center gap-3 flex-wrap">
          <button class="btn btn-outline-primary bet-btn" data-bet="1" type="button">₹1</button>
          <button class="btn btn-outline-primary bet-btn" data-bet="2" type="button">₹2</button>
          <button class="btn btn-outline-primary bet-btn" data-bet="5" type="button">₹5</button>
        </div>
      </div>

      <div class="d-flex justify-content-center my-3">
        <div class="slot" id="slot1">?</div>
        <div class="slot" id="slot2">?</div>
        <div class="slot" id="slot3">?</div>
      </div>

      <button id="playBtn" class="btn btn-success mb-3" disabled>Spin</button>

      <div id="gameResult" class="text-center fs-5"></div>

      <button id="addFundsBtn" class="btn btn-warning mt-3">➕ Add Funds</button>
    </div>
  </div>

  <!-- Add Funds Modal -->
  <div class="modal fade" id="addFundsModal" tabindex="-1" aria-labelledby="addFundsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addFundsModalLabel">Add Funds</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="closeModalBtn"></button>
        </div>
        <div class="modal-body text-center">
          <p>Scan this UPI QR code with your app and then enter the amount and UTR below:</p>
          <canvas id="qrCode"></canvas>
          <div class="mb-3">
            <label for="amountInput" class="form-label">Amount (₹)</label>
            <input id="amountInput" type="number" min="1" class="form-control" autocomplete="off" />
          </div>
          <div class="mb-3">
            <label for="utrInput" class="form-label">UTR / Transaction ID</label>
            <input id="utrInput" type="text" class="form-control" autocomplete="off" />
          </div>
          <button id="confirmFunds" class="btn btn-primary w-100">Confirm Payment</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- QRCode.js -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

  <script>
    // Initial wallet balance
    let wallet = 50;
    let currentBet = 0;
    const symbols = ["🍒", "🍋", "🔔", "🍀", "💎"];
    const walletBalanceEl = document.getElementById("walletBalance");
    const playBtn = document.getElementById("playBtn");
    const gameResultEl = document.getElementById("gameResult");
    const addFundsModalEl = document.getElementById("addFundsModal");
    const addFundsModal = new bootstrap.Modal(addFundsModalEl);

    // Your UPI ID (change this)
    const upiID = "8144091101-2@ybl";

    // Utility functions
    function updateWallet() {
      walletBalanceEl.textContent = wallet;
    }
    function clearAddFundsInputs() {
      document.getElementById("amountInput").value = "";
      document.getElementById("utrInput").value = "";
    }
    function resetGameResult() {
      gameResultEl.textContent = "";
      gameResultEl.classList.remove("text-success", "text-danger");
    }
    function generateUpiQr(amount = "") {
      const qrContainer = document.getElementById("qrCode");
      let url = `upi://pay?pa=${encodeURIComponent(upiID)}&pn=Web%20Developer&cu=INR`;
      if (amount && amount > 0) {
        url += `&am=${amount}`;
      }
      QRCode.toCanvas(qrContainer, url, { width: 200 }, function (error) {
        if (error) console.error(error);
      });
    }

    // Contact form submit -> show game
    document.getElementById("contactForm").addEventListener("submit", (e) => {
      e.preventDefault();
      document.getElementById("gameArea").style.display = "block";
      document.getElementById("contactSection").style.display = "none";
    });

    // Bet button clicks
    document.querySelectorAll(".bet-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        currentBet = Number(btn.getAttribute("data-bet"));
        playBtn.disabled = false;
        resetGameResult();
        // Highlight selected bet
        document.querySelectorAll(".bet-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      });
    });

    // Spin slots
    playBtn.addEventListener("click", () => {
      if (!currentBet) {
        alert("Select a bet");
        return;
      }
      if (wallet < currentBet) {
        alert("Insufficient funds");
        return;
      }
      wallet -= currentBet;
      updateWallet();

      const s1 = symbols[Math.floor(Math.random() * symbols.length)];
      const s2 = symbols[Math.floor(Math.random() * symbols.length)];
      const s3 = symbols[Math.floor(Math.random() * symbols.length)];

      document.getElementById("slot1").textContent = s1;
      document.getElementById("slot2").textContent = s2;
      document.getElementById("slot3").textContent = s3;

      if (s1 === s2 && s2 === s3) {
        const win = currentBet * 10;
        wallet += win;
        updateWallet();
        gameResultEl.textContent = `🎉 JACKPOT! ₹${win} added!`;
        gameResultEl.classList.remove("text-danger");
        gameResultEl.classList.add("text-success");
      } else {
        gameResultEl.textContent = "😢 Try again!";
        gameResultEl.classList.remove("text-success");
        gameResultEl.classList.add("text-danger");
      }
    });

    // Show add funds modal & generate initial QR
    document.getElementById("addFundsBtn").addEventListener("click", () => {
      clearAddFundsInputs();
      generateUpiQr();
      addFundsModal.show();
    });

    // Update QR when amount input changes
    document.getElementById("amountInput").addEventListener("input", (e) => {
      const amount = e.target.value;
      generateUpiQr(amount);
    });

    // Confirm payment
    document.getElementById("confirmFunds").addEventListener("click", () => {
      const amount = Number(document.getElementById("amountInput").value);
      const utr = document.getElementById("utrInput").value.trim();

      if (!amount || amount <= 0) {
        alert("Enter valid amount");
        return;
      }
      if (!utr || utr.length < 4) {
        alert("Enter valid UTR");
        return;
      }

      wallet += amount;
      updateWallet();
      alert(`✅ ₹${amount} added to your wallet successfully!`);

      clearAddFundsInputs();
      generateUpiQr(); // reset QR without amount

      // Modal stays open, user can add more funds if they want
    });
  </script>
</body>
</html>
